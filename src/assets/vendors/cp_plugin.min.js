/*! obiee-super-graphs - v1.0.0 - 2016-10-25 */
$.fn.cp_bubble=function(a){var b=$.extend(!0,{design:{fillColor:"#009CCC",unit:"%",scoreFontSize:"22",scoreFontFamily:"Helvetica",scoreFontColor:"#666666",titleFontSize:"12",titleFontFamily:"Helvetica",titleFontColor:"#666666",titlePosition:"center",gap:"3",displayText:"true"},size:{radius:"40",width:"100",height:"100",lineWidth:"10"},data:{canvas_id:"c1",score:"90",max:"100",subtitle:"Awesome"}},a),c=document.createElement("canvas");c.id=b.data.canvas_id,$(this).html(c.outerHTML);var d=document.getElementById(b.data.canvas_id),e=d.getContext("2d"),f=b.data.score;b.data.max;d.width=b.size.width,d.height=b.size.height,d.style.display="block",d.style.margin="auto";var g=d.width/2,h=d.height/2,i=b.size.radius;e.beginPath(),e.arc(g,h,i,0,2*Math.PI,!1),e.fillStyle=b.design.fillColor,e.fill();var a=i-(2*i-2*i*(b.data.score/b.data.max)),j=Math.asin(a/i);if(console.log(j),j>1.5&&(j=1.5),-1.5>j&&(j=-1.5),e.beginPath(),e.arc(g,h,i,0-j,1*Math.PI+j,!0),e.fillStyle="rgba(255,255,255,0.5)",e.fill(),"true"==b.design.displayText){e.font=b.design.scoreFontSize+"px "+b.design.scoreFontFamily,e.fillStyle=b.design.scoreFontColor;var k,l,m,n=0;null==b.data.subtitle?(k=h+b.design.scoreFontSize/2.5,l=g-e.measureText(f+b.design.unit).width/2):(l=g-e.measureText(f+b.design.unit).width/2,n=g-e.measureText(b.data.subtitle).width/2,"center"==b.design.titlePosition?(k=h+b.design.scoreFontSize/2-b.design.titleFontSize/2-b.design.gap/2,m=h+(b.design.scoreFontSize/2+b.design.titleFontSize/2+b.design.gap/1)):"bottom"==b.design.titlePosition?(k=h+b.design.scoreFontSize/2.5,m=h+1*i+1*b.design.gap):"top"==b.design.titlePosition?(k=h+b.design.scoreFontSize/2.5,m=h-1*i-1*b.design.gap):(k=h+b.design.scoreFontSize/2-b.design.titleFontSize/2-b.design.gap/2,m=h+(b.design.scoreFontSize/2+b.design.titleFontSize/2+b.design.gap/1))),e.fillText(f+b.design.unit,l,k),e.fillStyle=b.design.titleFontColor,e.font=b.design.titleFontSize+"px "+b.design.titleFontFamily,e.fillText(b.data.subtitle,g-e.measureText(b.data.subtitle).width/2,m)}},$.fn.cp_circle=function(a){var b=$.extend(!0,{design:{borderWidth:"1px",borderColor:"#009CCC",boderStyle:"none",backgroundColor:"#009CCC",fontColor:"#FFFFFF",fontFamily:"Segoe UI, Arial",fontSize:"36",offset:0,subtitleFontSize:"12",clickFunction:"",icon:"",iconPosition:"left",iconPaddingLeft:"0",iconPaddingRight:"0"},size:{width:"120px",height:"120px",radius:"50",borderRadius:"50"},data:{value:"42",subtitle:"is the asnwer"}},a);return this.each(function(){var a=2*b.size.radius,c=$.parseHTML("<div>");$(c).css({display:"flex",flexDirection:"column",width:a,height:a,margin:"auto",borderRadius:b.size.borderRadius+"%",borderWidth:b.design.borderWidth,borderStyle:b.design.borderStyle,color:b.design.fontColor,textAlign:"center",borderColor:b.design.borderColor,backgroundColor:b.design.backgroundColor,position:"relative"});var d=$.parseHTML("<div>");if($(d).css({position:"relative",fontSize:b.design.fontSize,margin:"auto",fontFamily:b.design.fontFamily}),$(d).text(b.data.value),""!=b.design.icon){var e=$.parseHTML("<i>");$(e).addClass("fa"),$(e).addClass(b.design.icon),$(e).css({paddingLeft:b.design.iconPaddingLeft,paddingRight:b.design.iconPaddingRight}),"left"==b.design.iconPosition?$(d).prepend(e):$(d).append(e)}if(""!=b.design.clickFunction&&"function"==typeof window[b.design.clickFunction]&&($(d).on("click",window[b.design.clickFunction]),$(d).css("cursor","pointer")),$(c).append(d),""!=b.data.subtitle){$(d).css("marginBottom",0);var f=$.parseHTML("<div>");$(f).css({position:"realtive",fontSize:b.design.subtitleFontSize,margin:"auto",marginTop:0,fontFamily:b.design.fontFamily}),$(f).text(b.data.subtitle),$(c).append(f)}$(this).html(c)})},$.fn.cp_donut=function(a){var b=$.extend(!0,{design:{fillColor:"#009CCC",remainingColor:"#E4E4E4",circleFillColor:"rgba(255,255,255,0)",unit:"%",scoreFontSize:"22",scoreFontFamily:"Helvetica",scoreFontColor:"#666666",titleFontSize:"12",titleFontFamily:"Helvetica",titleFontColor:"#666666",gap:"3",displayText:"true",clickFunction:"",lineStyle:"solid",dashWidth:2,dashGaps:2,animate:!1,animateInterval:5},size:{radius:"40",width:"100",height:"100",lineWidth:"10"},data:{canvas_id:"c1",score:"90",max:"100",subtitle:"Awesome"}},a),c=document.createElement("canvas");c.id=b.data.canvas_id,$(this).html(c.outerHTML);var d=document.getElementById(b.data.canvas_id);""!=b.design.clickFunction&&"function"==typeof window[b.design.clickFunction]&&(console.log(b.design.clickFunction),d.addEventListener("click",window[b.design.clickFunction]),d.style.cursor="pointer");var e=d.getContext("2d"),f=d.getContext("2d"),g=(d.getContext("2d"),b.data.score),h=b.data.max;d.width=b.size.width,d.height=b.size.height;var i=d.width/2,j=d.height/2,k=b.size.radius;if(f.beginPath(),f.arc(i,j,k,1.5*Math.PI,200*Math.PI/100+1.5*Math.PI,!1),f.lineWidth=b.size.lineWidth,f.strokeStyle=b.design.remainingColor,f.stroke(),0==b.design.animate)e.beginPath(),e.arc(i,j,k,1.5*Math.PI,2*g*Math.PI/h+1.5*Math.PI,!1),e.lineWidth=b.size.lineWidth,e.strokeStyle=b.design.fillColor,"dashed"==b.design.lineStyle&&(e.translate(.5,.5),e.setLineDash([b.design.dashWidth,b.design.dashGaps])),e.fillStyle=b.design.circleFillColor,e.fill(),e.stroke();else var l=0,m=2*g*Math.PI/h,n=l,o=setInterval(function(){e.beginPath(),e.arc(i,j,k,1.5*Math.PI,n+1.5*Math.PI,!1),e.lineWidth=b.size.lineWidth,e.strokeStyle=b.design.fillColor,"dashed"==b.design.lineStyle&&e.setLineDash([b.design.dashWidth,b.design.dashGaps]),e.stroke(),n+=.01,n>=m&&clearInterval(o)},b.design.animateInterval);if("true"==b.design.displayText){e.font=b.design.scoreFontSize+"px "+b.design.scoreFontFamily,e.fillStyle=b.design.scoreFontColor;var p,q,r,s=0;null==b.data.subtitle?(p=j+b.design.scoreFontSize/2.5,q=i-e.measureText(g+b.design.unit).width/2):(p=j+b.design.scoreFontSize/2-b.design.titleFontSize/2-b.design.gap/2,q=i-e.measureText(g+b.design.unit).width/2,s=i-e.measureText(b.data.subtitle).width/2,r=j+(b.design.scoreFontSize/2+b.design.titleFontSize/2+b.design.gap/1)),e.fillText(g+b.design.unit,q,p),e.fillStyle=b.design.titleFontColor,e.font=b.design.titleFontSize+"px "+b.design.titleFontFamily,e.fillText(b.data.subtitle,i-e.measureText(b.data.subtitle).width/2,r)}},$.fn.cp_donutd3=function(a){var b=$.extend(!0,{design:{fillColor:"#009CCC",remainingColor:"#E4E4E4",circleFillColor:"rgba(255,255,255,0)",unit:"%",scoreFontSize:"22",scoreFontFamily:"Helvetica",scoreFontColor:"#666666",titleFontSize:"12",titleFontFamily:"Helvetica",titleFontColor:"#666666",gap:"3",displayText:"true",clickFunction:"",lineStyle:"solid",dashWidth:2,dashGaps:2,animate:!1,animateInterval:5},size:{radius:"40",width:"100",height:"100",lineWidth:"10"},data:{canvas_id:"c1",score:"90",max:"100",subtitle:"Awesome"}},a),c=[b.design.fillColor,b.design.remainingColor],d=d3.layout.pie().sort(null),e=b.size.width,f=b.size.height,g=b.size.radius,h=g-b.size.lineWidth,i=d3.svg.arc().innerRadius(h).outerRadius(g),j=d3.select(this[0]).append("svg").attr("width",e).attr("height",f).style("margin","auto").style("display","block"),k=j.selectAll("g.arc").data(d([b.data.score,100-b.data.score])).enter().append("g").attr("class",i).attr("transform","translate("+g+","+g+")"),l=k.selectAll("text").data([{text:b.data.score+b.design.unit,offset:0,fontSize:b.design.scoreFontSize+"px",fontFamily:b.design.scoreFontFamily,color:b.design.scoreFontColor},{text:b.data.subtitle,offset:20,fontSize:b.design.titleFontSize+"px",fontFamily:b.design.titleFontFamily,color:b.design.titleFontColor}]).enter().append("text");l.attr("y",function(a){return a.offset}).attr("text-anchor","middle").text(function(a){return a.text}).attr("font-family",function(a){return a.fontFamily}).attr("font-size",function(a){return a.fontSize}).attr("fill",function(a){return a.color});k.append("path").attr("fill",function(a,b){return c[b]}).attr("d",i)}(function(a){a.fn.cp_gauge=function(b){var c=a.extend(!0,{design:{needleColor:"#000",lowerBoxVisible:"true",lowerBoxHeight:25,lowerBoxBackground:"#AAA",lowerBoxTextcolor:"#FFF",lowerBoxTextSize:13,upperBoxVisible:"true",upperBoxText:"",upperBoxTextColor:"#777",upperBoxTextSize:30},size:{rangeSize:35,minorTick:10},data:{value:0,max:100,unit:"",dataRange:[{from:0,to:100,color:"#CCC"}],textBox:[{lowerBoxText:"value is.."}]}},b);return this.each(function(){function b(a,b,c,d){var e=b*a,f=3.14159,g=Math.sin(e*(f/180))*c,h=Math.cos(e*(f/180))*c,i=d-g,j=d-h;return[j,i]}for(var d in c.data.dataRange)c.data.max<c.data.dataRange[d].to&&(c.data.max=c.data.dataRange[d].to);for(var e=3.14159,f=180/c.data.max,g=f*c.data.value,h="",i=0;i<=c.data.max;i+=c.size.minorTick){var j=b(i,f,77,100),k=b(i,f,85,100),l=b(i,f,92,100),m='<line  x1="'+j[0]+'" y1="'+j[1]+'"  x2="'+k[0]+'" y2="'+k[1]+'" stroke-width="0.5" stroke="#2E2E2E"/><text text-anchor="middle" x="'+l[0]+'"  y="'+l[1]+'"  style="font-size: 10px;" fill="#2E2E2E">'+i+c.data.unit+"</text>";h+=m}var n=b(c.data.value,f,80,100),o=3*Math.sin((90-g)*(e/180)),p=3*Math.cos((90-g)*(e/180)),q=100+p,r=96-o,s=100-p,t=96+o,u=a(this),v=a.parseHTML('<div style="width:100%;height:100%" class="gaugeContainer"> </div>');u.append(v);var w,x=u.find(".gaugeContainer"),y=180/c.data.max;for(var d in c.data.dataRange){var z=-180+c.data.dataRange[d].from*y,m='<circle cx="100" cy="100" r="57" fill="none" stroke="'+c.data.dataRange[d].color+'" stroke-width="'+c.size.rangeSize+'" transform="rotate('+z+',100,100)" stroke-dasharray="'+(c.data.dataRange[d].to-c.data.dataRange[d].from)*y+',2000" />';w+=m}if(x.append(a('<svg viewBOx="0 0 205 100"><circle cx="100" cy="100" r="57" fill="none" stroke="#ccc" stroke-width="'+c.size.rangeSize+'" />'+w+'<circle cx="100" cy="96" r="4" fill-opacity="1" stroke-opacity="1" fill="'+c.design.needleColor+'"></circle><path  style="display: block; " d="M'+n[0]+"+"+n[1]+" "+q+" "+r+" "+s+" "+t+' z" stroke-linecap="square" stroke-linejoin="round" fill-opacity="1" stroke-opacity="1" fill="'+c.design.needleColor+'"></path>'+h)),"true"==c.design.lowerBoxVisible){var A=a.parseHTML('<div style ="height:'+c.design.lowerBoxHeight+"px;background-color:"+c.design.lowerBoxBackground+';" class="lower_box"><div class="lower_box_inner" width="100%" height="100%"></div></div>');x.append(A);for(var d=0;d<c.data.textBox.length;d++){var B=a.parseHTML('<div style ="line-height:'+c.design.lowerBoxHeight+"px;color:"+c.design.lowerBoxTextcolor+";font-size:"+c.design.lowerBoxTextSize+'px" class="lower_box_text">'+c.data.textBox[d].lowerBoxText+" </div>");u.find(".lower_box_inner").append(B)}}if("true"==c.design.upperBoxVisible){var C=c.design.upperBoxText;""==c.design.upperBoxText&&(C=c.data.value);var D=a.parseHTML('<div style="font-size:'+c.design.upperBoxTextSize+"px;font-weight:500;color:"+c.design.upperBoxTextColor+';text-align:center;font-family:Century Gothic;    padding-bottom: 8px;">'+C+"</div>");x.prepend(D)}})}}(jQuery)),$.fn.cp_horizontal_bar=function(a){var b=$.extend(!0,{design:{fillColor:"#009CCC",remainingColor:"#E4E4E4",paddingBottom:"1px",showValues:"true",markerFontFamily:"Segoe UI",markerFontSize:14,markerFontColor:"#FFFFFF",markerPaddingLeft:"5px",markerUnit:"",markerValuesLocation:"middle",showAxisValues:"true",axisFontFamily:"Segoe UI",axisFontSize:"14",axisFontColor:"#666666",axisPaddingTop:"3px",axisRotation:"315deg"},size:{barWidth:350,barHeight:20},data:{value:7,maxValue:10,axisValue:"Dec"}},a);return this.each(function(){var a=document.createElement("div");a.style.cssText="margin:auto;width:"+b.size.barWidth+"px;height:"+b.size.barHeight+"px;position:relative;padding-bottom:"+b.design.paddingRight;var c=document.createElement("div");c.style.height=b.size.barHeight+"px",c.style.width=b.size.barWidth+"px",c.style.position="absolute",c.style.backgroundColor=b.design.remainingColor;var d=document.createElement("div"),e=b.size.barWidth*b.data.value/b.data.maxValue;b.size.barWidth-e;if(d.style.width=e+"px",d.style.height=b.size.barHeight+"px",d.style.position="absolute",d.style.backgroundColor=b.design.fillColor,a.appendChild(c),a.appendChild(d),"true"==b.design.showValues){var f=document.createElement("div"),g=0;"right"==b.design.markerValuesLocation||e<1*b.design.markerFontSize+5?(console.log(e),g=e+5):g="middle"==b.design.markerValuesLocation?e/2:e-b.design.markerFontSize-5-b.design.markerFontSize/2,f.style.left=g+"px",f.textContent=b.data.value+""+b.design.markerUnit,f.style.position="absolute",f.style.textAlign="center",f.style.lineHeight=b.size.barHeight+"px",f.style.fontFamily=b.design.markerFontFamily,f.style.color=b.design.markerFontColor,f.style.fontSize=b.design.markerFontSize,f.style.paddingLeft=b.design.markerPaddingTop,a.appendChild(f)}$(this).html(a.outerHTML)})},$.fn.cp_kpi_tile=function(a){var b=$.extend(!0,{design:{titleFontSize:"14px",kpiFontSize:"28px",subtitleFontSize:"11px",fontFamily:"Segoe UI,Hevetica",tileBorder:"1px solid #666666"},size:{titleHeight:"25%",kpiHeight:"60%",subtitleHeight:"15%",kpiContainerWidht:"70%",extraIndicatorsWidth:"30%"},data:{kpi:{title:"FEED",kpi:"6,478",kpi_color:"#00FF00",subtitle:"MMSCFD"},extra_indicators:[{title:"",icon:"",indicator:"+5%",indicator_color:"#00FF00"},{title:"",icon:"",indicator:"-1,500",indicator_color:"#FF0000"}]}},a);return this.each(function(){var a=$.parseHTML("<div>");$(a).css({display:"flex","flex-direction":"row","justify-content":"center","align-items":"center",border:b.design.tileBorder});var c=$.parseHTML("<div>");$(c).css({display:"flex","flex-direction":"column","justify-content":"center","align-items":"center","font-family":b.design.fontFamily,width:b.size.kpiContainerWidht});var d=$.parseHTML("<div>");$(d).css({color:"#666666","font-size":b.design.titleFontSize}),$(d).text(b.data.kpi.title);var e=$.parseHTML("<div>");$(e).css({color:b.data.kpi.kpi_color,"font-size":b.design.kpiFontSize}),$(e).text(b.data.kpi.kpi);var f=$.parseHTML("<div>");$(f).css({color:"#666666","font-size":b.design.subtitleFontSize}),$(f).text(b.data.kpi.subtitle),$(c).append(d),$(c).append(e),$(c).append(f);var g=$.parseHTML("<div>");$(g).css({display:"flex","flex-direction":"column","justify-content":"center","align-items":"center",height:"50%",width:b.size.extraIndicatorsWidth}),$.each(b.data.extra_indicators,function(a){var c=$.parseHTML("<div>");$(c).text(b.data.extra_indicators[a].indicator),$(c).css({color:b.data.extra_indicators[a].indicator_color,display:"flex","align-items":"center","justify-content":"center",height:"100%",width:"100%"}),$(g).append(c)}),$(a).append(c),$(a).append(g),$(this).html($(a)[0].outerHTML)})},$.fn.cp_percentage_bar_h=function(a){var b=$.extend(!0,{design:{positiveColor:"#4DB6AC",negativeColor:"#E57373",remainingColor:"#FFF",paddingRight:"5px",showValues:"true",showDelta:"false",markerFontFamily:"Segoe UI",markerFontSize:"10",markerFontColor:"#666666",markerUnit:"%",markerValuesLocation:"middle",markerBarColor:"#999999",axisFontFamily:"Segoe UI",axisFontSize:"10",axisFontColor:"#666666",deltaUnit:"",scaleBarPosition:"top",displayZeroline:"true",zerolineColor:"#C4C4C4"},size:{barWidth:65,barHeight:15,scaleHeight:5,zerolineHeight:28,zerolineWidth:2},data:{referenceValue:"",newValue:"",delta:"",value:35,maxValue:100,minValue:-100}},a);return this.each(function(){""!=b.data.newValue&&""!=b.data.referenceValue&&(b.data.delta=Math.round(10*(b.data.newValue-b.data.referenceValue))/10,0==b.data.referenceValue?b.data.value=0:b.data.value=Math.floor(100*(b.data.newValue-b.data.referenceValue)/b.data.referenceValue),b.data.value>100?(b.data.maxValue=b.data.value,b.data.minValue=-100):b.data.value<-100?(b.data.maxValue=100,b.data.minValue=-1*b.data.value):(b.data.maxValue=100,b.data.minValue=-100));var a=$.parseHTML("<div>");$(a).css({display:"flex","flex-direction":"column",width:2*b.size.barWidth});var c=$.parseHTML("<div>");$(c).css({display:"flex","flex-direction":"row",height:b.size.scaleHeight,width:2*b.size.barWidth,"margin-bottom":b.design.paddingRight}),"top"==b.design.scaleBarPosition?$(c).css({"margin-bottom":b.design.paddingRight}):$(c).css({"margin-top":b.design.paddingRight});var d=$.parseHTML("<div>");$(d).css({height:"100%",width:"50%",display:"flex","justify-content":"flex-start","border-left":"2px solid "+b.design.markerBarColor});var e=$.parseHTML("<div>");$(e).css({height:"100%",width:"50%",display:"flex","justify-content":"flex-start","border-left":"2px solid "+b.design.markerBarColor,"border-right":"2px solid "+b.design.markerBarColor,position:"relative"});var f=$.parseHTML("<div>");$(f).css({width:b.size.zerolineWidth,"z-index":1,left:-2,height:b.size.zerolineHeight,"background-color":b.design.zerolineColor,position:"absolute"}),"top"==b.design.scaleBarPosition?($(d).css({"border-bottom":"2px solid "+b.design.markerBarColor}),$(e).css({"border-bottom":"2px solid "+b.design.markerBarColor})):($(d).css({"border-top":"2px solid "+b.design.markerBarColor}),$(e).css({"border-top":"2px solid "+b.design.markerBarColor}),$(f).css({top:-1*b.size.zerolineHeight-2+5}));var g=$.parseHTML("<div>");$(g).css({display:"flex","flex-direction":"row",width:2*b.size.barWidth,position:"relative","margin-bottom":"5px",height:"10px"});var h=$.parseHTML("<div>");$(h).text(b.data.maxValue+b.design.markerUnit),$(h).css({position:"absolute",left:2*b.size.barWidth-10,"font-size":b.design.markerFontSize+"px","font-family":b.design.markerFontFamily,"text-align":"right",height:"100%",color:b.design.markerFontColor});var i=$.parseHTML("<div>");$(i).text("0"),$(i).css({position:"absolute",left:b.size.barWidth-3,"font-size":b.design.markerFontSize+"px","font-family":b.design.markerFontFamily,"text-align":"right",height:"100%",color:b.design.markerFontColor});var j=$.parseHTML("<div>");$(j).text(b.data.minValue+b.design.markerUnit),$(j).css({position:"absolute",left:-10,"font-size":b.design.markerFontSize+"px","font-family":b.design.markerFontFamily,"text-align":"right",height:"100%",color:b.design.markerFontColor}),$(g).append(h),$(g).append(i),$(g).append(j),"true"==b.design.displayZeroline&&$(e).append(f),$(c).append(d),$(c).append(e);var k=$.parseHTML("<div>");$(k).css({display:"flex","flex-direction":"row",height:b.size.barHeight,width:2*b.size.barWidth,"margin-right":"10px"});var l=0,m=0;b.data.value>=0?(m=0,l=b.size.barWidth*b.data.value/b.data.maxValue):(m=b.size.barWidth*b.data.value/b.data.minValue,l=0),console.log(l),console.log(m);var n=$.parseHTML("<div>"),o=$.parseHTML("<div>");$(n).css({display:"flex",wdith:"50%",design:"flex","justify-content":"flex-start","background-color":b.design.remainingColor}),$(o).css({display:"flex",width:"50%",design:"flex","justify-content":"flex-end","background-color":b.design.remainingColor});var p=$.parseHTML("<div>");$(p).css({width:l,height:b.size.barHeight,"background-color":b.design.positiveColor,position:"relative"});var q=$.parseHTML("<div>");$(q).css({width:m,height:b.size.barHeight,"background-color":b.design.negativeColor,position:"relative"});var r=$.parseHTML("<div>");if("true"==b.design.showValues){var s=b.data.value+b.design.markerUnit;"true"==b.design.showDelta&&(s+=" ("+(b.data.value>0?"+":"")+b.data.delta+b.design.deltaUnit+")"),$(r).text(s)}$(r).css({"font-size":b.design.axisFontSize+"px","font-family":b.design.axisFontFamily,color:b.design.axisFontColor,height:"100%",position:"absolute"}),$(o).append(q),$(n).append(p),$(k).append(o),$(k).append(n);var t=3,u=33;b.data.value>=0?($(p).append(r),$(r).offset({left:$(r).position().left+l+t})):($(q).append(r),$(r).offset({left:$(r).position().left-u})),"top"==b.design.scaleBarPosition?($(a).append(g),$(a).append(c),$(a).append(k)):($(a).append(k),$(a).append(c),$(a).append(g)),$(this).html($(a)[0].outerHTML)})},$.fn.cp_percentage_bar=function(a){var b=$.extend(!0,{design:{positiveColor:"#4DB6AC",negativeColor:"#E57373",remainingColor:"#FFF",paddingRight:"10",showValues:"true",showDelta:"false",markerFontFamily:"Segoe UI",markerFontSize:"10",markerFontColor:"#666666",markerUnit:"%",markerValuesLocation:"middle",markerBarColor:"#666666",axisFontFamily:"Segoe UI",axisFontSize:"10",axisFontColor:"#666666",deltaUnit:"",scaleBarPosition:"right",displayZeroline:"true",zerolineColor:"#C4C4C4"},size:{barWidth:25,barHeight:65,scaleWidth:10,zerolineWidth:35,zerolineHeight:2},data:{referenceValue:"",newValue:"",delta:"",value:35,maxValue:100,minValue:-100}},a);return""!=b.data.newValue&&""!=b.data.referenceValue&&(b.data.delta=Math.round(10*(b.data.newValue-b.data.referenceValue))/10,0==b.data.referenceValue?b.data.value=0:(b.data.value=Math.floor(100*(b.data.newValue-b.data.referenceValue)/b.data.referenceValue),console.log("derived: "+b.data.value)),b.data.value>100?(b.data.maxValue=b.data.value,b.data.minValue=-100):b.data.value<-100?(b.data.maxValue=100,b.data.minValue=-1*b.data.value):(b.data.maxValue=100,b.data.minValue=-100)),this.each(function(){var a=$.parseHTML("<div>");$(a).css({display:"flex","flex-direction":"row",height:2*b.size.barHeight});var c=$.parseHTML("<div>");$(c).css({display:"flex","flex-direction":"column",height:2*b.size.barHeight,width:b.size.scaleWidth,"margin-right":b.design.paddingRight});var d=$.parseHTML("<div>");$(d).css({height:"50%",width:"100%",display:"flex","justify-content":"flex-start","border-top":"2px solid "+b.design.markerBarColor});var e=$.parseHTML("<div>");$(e).css({height:"50%",width:"100%",display:"flex","justify-content":"flex-start","border-top":"2px solid "+b.design.markerBarColor,"border-bottom":"2px solid "+b.design.markerBarColor,position:"relative"});var f=$.parseHTML("<div>");$(f).css({height:b.size.zerolineHeight,"z-index":1,top:-2,width:b.size.zerolineWidth,"background-color":b.design.zerolineColor,position:"absolute"}),"right"==b.design.scaleBarPosition?($(d).css({"border-left":"2px solid "+b.design.markerBarColor}),$(e).css({"border-left":"2px solid "+b.design.markerBarColor}),$(f).css({left:-1*b.size.zerolineWidth-2})):($(d).css({"border-right":"2px solid "+b.design.markerBarColor}),$(e).css({"border-right":"2px solid "+b.design.markerBarColor}),$(f).css({left:"5"}));var g=$.parseHTML("<div>");$(g).css({display:"flex","flex-direction":"column",height:2*b.size.barHeight,"margin-right":"5px",position:"relative",width:"40px"});var h=$.parseHTML("<div>");$(h).text(b.data.maxValue+b.design.markerUnit),$(h).css({position:"absolute",top:0-b.design.markerFontSize/2,"font-size":b.design.markerFontSize+"px","font-family":b.design.markerFontFamily,"text-align":"right"==b.design.scaleBarPosition?"left":"right",width:"100%",color:b.design.markerFontColor});var i=$.parseHTML("<div>");$(i).text("0"),$(i).css({position:"absolute",top:b.size.barHeight-b.design.markerFontSize/2,"font-size":b.design.markerFontSize+"px","font-family":b.design.markerFontFamily,"text-align":"right"==b.design.scaleBarPosition?"left":"right",width:"100%",color:b.design.markerFontColor});var j=$.parseHTML("<div>");$(j).text(b.data.minValue+b.design.markerUnit),$(j).css({position:"absolute",top:2*b.size.barHeight-b.design.markerFontSize/2,"font-size":b.design.markerFontSize+"px","font-family":b.design.markerFontFamily,"text-align":"right"==b.design.scaleBarPosition?"left":"right",width:"100%",color:b.design.markerFontColor}),$(g).append(h),$(g).append(i),$(g).append(j),"true"==b.design.displayZeroline&&$(e).append(f),$(c).append(d),$(c).append(e);var k=$.parseHTML("<div>");$(k).css({display:"flex","flex-direction":"column",height:2*b.size.barHeight,width:b.size.barWidth,"margin-right":"10px"});var l=0,m=0;b.data.value>=0?(m=0,l=b.size.barHeight*b.data.value/b.data.maxValue):(m=b.size.barHeight*b.data.value/b.data.minValue,l=0),console.log(l),console.log(m);var n=$.parseHTML("<div>"),o=$.parseHTML("<div>");$(n).css({display:"flex",height:"50%",design:"flex","align-items":"flex-end","background-color":b.design.remainingColor}),$(o).css({display:"flex",height:"50%",design:"flex","align-items":"flex-start","background-color":b.design.remainingColor});var p=$.parseHTML("<div>");$(p).css({height:l,width:b.size.barWidth,"background-color":b.design.positiveColor,position:"relative"});var q=$.parseHTML("<div>");$(q).css({height:m,width:b.size.barWidth,"background-color":b.design.negativeColor,position:"relative"});var r=$.parseHTML("<div>");if("true"==b.design.showValues){var s=b.data.value+b.design.markerUnit;"true"==b.design.showDelta&&(s+=" ("+(b.data.value>0?"+":"")+b.data.delta+b.design.deltaUnit+")"),$(r).text(s)}$(r).css({"font-size":b.design.axisFontSize+"px","font-family":b.design.axisFontFamily,"text-align":"center",color:b.design.axisFontColor,width:"100%",position:"absolute"}),$(n).append(p),$(o).append(q),$(k).append(n),$(k).append(o);var t="true"==b.design.showDelta?2*b.design.axisFontSize+12:1*b.design.axisFontSize+6;b.data.value>=0?($(p).append(r),$(r).offset({top:$(r).position().top-t})):($(q).append(r),$(r).offset({top:$(r).position().top+m})),"right"==b.design.scaleBarPosition?($(a).append(k),$(a).append(c),$(a).append(g)):($(a).append(g),$(a).append(c),$(a).append(k)),$(this).html($(a)[0].outerHTML)})},$.fn.cp_pyramid=function(a){var b=$.extend(!0,{design:{showOutline:"false",outlineColor:"#4DB6AC",outlineWidth:"2",drawValueLines:"true"},size:{base:300,height:180},data:{sections:[{color:"red",label:{text:"Sections",fontFamily:"Verdana",fontSize:16,fontColor:"#37474F"},value:{text:70,gap:20,fontFamily:"Verdana",fontSize:16,fontColor:"#666"}},{color:"green",label:{text:"Departments",fontFamily:"Verdana",fontSize:14,fontColor:"#37474F"},value:{text:42,gap:20,fontFamily:"Verdana",fontSize:16,fontColor:"#666"}},{color:"blue",label:{text:"Divisions",fontFamily:"Verdana",fontSize:12,fontColor:"#37474F"},value:{text:20,gap:20,fontFamily:"Verdana",fontSize:16,fontColor:"#666"}},{color:"red",label:{text:"Groups",fontFamily:"Verdana",fontSize:10,fontColor:"#37474F"},value:{text:7,gap:20,fontFamily:"Verdana",fontSize:16,fontColor:"#666"}}]}},a);return this.each(function(){var a={b:b.size.base,h:b.size.height,s:b.data.sections.length},c=$.parseHTML("<canvas>");$(c)[0].width=a.b+100,$(c)[0].height=a.h;var d=$(c)[0].getContext("2d");"true"==b.design.showOutline&&(d.beginPath(),d.moveTo(0,a.h),d.lineTo(a.b,a.h),d.lineTo(a.b/2,0),d.closePath(),d.lineWidth=b.design.outlineWidth,d.strokeStyle=b.design.outlineColor,d.stroke());var e=0,f=0,g=a.h;r=0;for(var h=0;h<a.s;h++){d.beginPath(),d.moveTo(f,g),d.lineTo(a.b-r,a.h-e);var i=r;if(e+=a.h/a.s,r=a.b/2*e/a.h,d.lineTo(a.b-r,a.h-e),d.lineTo(r,a.h-e),d.closePath(),d.fillStyle=b.data.sections[h].color,d.fill(),"undefined"!=typeof b.data.sections[h].label){var j=$.extend(!0,{text:"<missing text>",fontFamily:"Arial",fontSize:10,fontColor:"black"},b.data.sections[h].label);d.fillStyle=j.fontColor,d.font=j.fontSize+"px "+j.fontFamily,d.fillText(j.text,a.b/2-d.measureText(j.text).width/2,a.h-e+a.h/a.s/2+j.fontSize/2)}if("undefined"!=typeof b.data.sections[h].value){var k=$.extend(!0,{text:"<missing value>",gap:20,fontFamily:"Arial",fontSize:10,fontColor:"black"},b.data.sections[h].value);d.fillStyle=k.fontColor,d.font=k.fontSize+"px "+k.fontFamily,d.fillText(k.text,a.b+k.gap,a.h-e+a.h/a.s/2+k.fontSize/2),"true"==b.design.drawValueLines&&(d.beginPath(),d.moveTo(a.b-i,a.h-e+a.h/a.s/2+3),d.lineTo(a.b+k.gap-5,a.h-e+a.h/a.s/2+3),d.lineWidth=1,d.strokeStyle="#666",d.closePath(),d.stroke())}f=r,g=a.h-e}var e=0,f=0,g=a.h;r=0;for(var h=0;h<a.s;h++)d.beginPath(),d.moveTo(f,g),d.lineTo(a.b-r,a.h-e),e+=a.h/a.s,r=a.b/2*e/a.h,d.lineTo(a.b-r,a.h-e),d.lineTo(r,a.h-e),d.closePath(),"undefined"!=typeof b.data.sections[h].outline&&(d.lineWidth=b.data.sections[h].outline.width,"dashed"==b.data.sections[h].outline.style&&d.setLineDash([10]),d.strokeStyle=b.data.sections[h].outline.color,d.stroke()),f=r,g=a.h-e;$(this).append(c)})},$.fn.cp_scale=function(a){var b=$.extend(!0,{design:{borderStyle:"none"},size:{length:300,height:35,color_frame_gap:2},data:{min:0,max:5,color_stops:["red","blue","white"]}},a);return this.each(function(){var a=$.parseHTML("<div>");$(a).css({border:b.design.borderStyle,width:b.size.length,height:b.size.height});for(var c=d3.scale.linear().domain([0,b.size.length/b.size.color_frame_gap/2,b.size.length/b.size.color_frame_gap]).range(b.data.color_stops),d=0;d<b.size.length/b.size.color_frame_gap;d++){var e=$.parseHTML("<div>");$(e).css({backgroundColor:c(d),display:"inline-block",height:"100%",width:b.size.color_frame_gap}),$(a).append(e)}$(this).append(a)})},$.fn.cp_scale_d3=function(a){for(var b=$.extend(!0,{design:{borderStyle:"none"},size:{length:300,height:35,color_frame_gap:2},data:{min:0,max:5,color_stops:["red","yellow","green"]}},a),c=d3.scale.linear().domain([b.data.min,b.data.max]).range([0,b.size.length]),d=d3.svg.axis().scale(c).orient("bottom"),e=d3.scale.linear().domain([0,b.size.length/b.size.color_frame_gap/2,b.size.length/b.size.color_frame_gap]).range(b.data.color_stops),f=d3.select(this[0]).append("svg").attr("width",b.size.length).attr("height",b.size.height).style("margin","auto").style("display","block"),g=[],h=0;h<b.size.length/b.size.color_frame_gap;h++)g[h]=h;console.log(g),f.selectAll("rect").data(g).enter().append("rect").attr({width:b.size.color_frame_gap,height:b.size.height,fill:function(a,b){return e(b)},x:function(a,c){return a*b.size.color_frame_gap}}),f.append("g").call(d)},$.fn.cp_tile=function(a){var b=$.extend(!0,{design:{backgroundColor:"#FFFFFF00",titleFontSize:"22",titleFontFamily:"Helvetica",titleFontColor:"#666666",titlePaddingTop:"5px",subtitleFontSize:"12",subtitleFontFamily:"Helvetica",subtitleFontColor:"#666666",borderStyle:"1px solid #EBEBEB"},size:{width:"150",height:"150",titleHeightPer:"15",contentHeightPer:"70",subtitleHeightPer:"15"},data:{content_id:"t_c1",title:"This is title",subtitle:"Awesome!"}},a);return this.each(function(){var a=document.createElement("div");a.style.width=b.size.width,a.style.height=b.size.height,a.style.backgroundColor=b.design.backgroundColor,a.style.border=b.design.borderStyle;var c=document.createElement("div");c.style.width="100%",c.style.height=b.size.height*(b.size.titleHeightPer/100),c.style.fontSize=b.design.titleFontSize,c.style.color=b.design.titleFontColor,c.style.fontFamily=b.design.titleFontFamily,c.style.textAlign="center",c.style.lineHeight=c.style.height,c.style.paddingTop=b.design.titlePaddingTop,c.innerText=b.data.title;var d=document.createElement("div");d.style.width="100%",d.style.height=b.size.height*(b.size.contentHeightPer/100),d.id=b.data.content_id,d.style.position="relative",d.style.margin="auto";var e=document.createElement("div");e.style.width="100%",e.style.height=b.size.height*(b.size.subtitleHeightPer/100),e.style.fontSize=b.design.subtitleFontSize,e.style.color=b.design.subtitleFontColor,e.style.fontFamily=b.design.subtitleFontFamily,e.style.textAlign="center",e.style.lineHeight=e.style.height,e.innerText=b.data.subtitle,a.appendChild(c),a.appendChild(d),a.appendChild(e),$(this).html(a.outerHTML)})},$.fn.cp_timeline=function(a){var b=$.extend(!0,{design:{lineColor:"#009CCC",markerColor:"#D4D4D4",markerFontSize:"12",highlighMarkerColor:"#3f3f3f",eventsFontFamily:"Helvetica",showMarkers:"true",showEvents:"true",showEventsCaption:"true",showMarkerCaption:"true",highlightGaps:"true",gapColor:"#E57373"},size:{lenght:400,height:100,paddingTop:50,markerPaddingTop:30,iconPaddingTop:0,lineWidth:2,markerRadius:4},data:{min:6,max:18,intervals:[{start:6.5,end:8.5,color:"#009CCC"}],markers:[7,15],events:[{value:6.5,icon:"fa-angle-up",caption:"in"},{value:15,icon:"fa-angle-down",caption:"out"}],dayDuration:24,prefix:"tl_"}},a);return this.each(function(){var a,c,d=b.data.min,e=b.data.max;d>e&&(e+=b.data.dayDuration,c=1);var f=b.size.lenght,g=b.size.height,h=f/(60*e-60*d),i=b.data.prefix+"container",j=document.createElement("div");j.id=i,j.style.width=f+"px",j.style.height=g+"px",j.style.position="relative",j.style.margin="auto";var k=document.createElement("div");if(k.id="timeline",k.style.width=f+"px",k.style.height=b.size.lineWidth+"px",k.style.backgroundColor="#E0E4CC",k.style.margin="auto",k.style.position="absolute",k.style.marginTop=b.size.paddingTop+"px",j.appendChild(k),"true"==b.design.highlightGaps){var l=b.data.intervals[0].start,m=b.data.intervals[b.data.intervals.length-1].end,n=document.createElement("div"),o=(60*m-60*l)*h;
n.style.width=o+"px",n.style.height=b.size.lineWidth+"px",n.style.backgroundColor=b.design.gapColor,n.style.position="absolute";var p=(60*l-60*d)*h;n.style.left=p+"px",n.style.marginTop=b.size.paddingTop+"px",j.appendChild(n)}c=0;for(interval in b.data.intervals){var q=b.data.intervals[interval].start,r=b.data.intervals[interval].end;1==c&&(r+=b.data.dayDuration,q+=b.data.dayDuration),q>r&&(r+=b.data.dayDuration,c=1);var n=document.createElement("div"),o=(60*r-60*q)*h;n.style.width=o+"px",n.style.height=b.size.lineWidth+"px",b.data.intervals[interval].hasOwnProperty("color")?n.style.backgroundColor=b.data.intervals[interval].color:n.style.backgroundColor=b.design.lineColor,n.style.position="absolute";var p=(60*q-60*d)*h;n.style.left=p+"px",n.style.marginTop=b.size.paddingTop+"px",j.appendChild(n)}if("true"==b.design.showMarkerCaption)for(var s=d;e>=s;s++){var t=document.createElement("div");a=s>=b.data.dayDuration?s-b.data.dayDuration:s,t.textContent=a,t.style.fontFamily="Open Sans",t.style.width="12px",t.style.textAlign="center",t.style.fontSize="10px",-1!=$.inArray(a,b.data.markers)?t.style.color=b.design.highlighMarkerColor:t.style.color=b.design.markerColor,t.style.position="absolute";var u=(60*s-60*d)*h-6;t.style.left=u+"px",t.style.top=b.size.markerPaddingTop+"px",j.appendChild(t)}if("true"==b.design.showMarkers)for(var v=0;v<b.data.markers.length;v++){var w=document.createElement("canvas");w.id=b.data.prefix+v,w.width=2*(b.size.markerRadius+b.size.lineWidth),w.height=2*(b.size.markerRadius+b.size.lineWidth),w.style.position="absolute";var x=b.size.paddingTop-b.size.markerRadius-b.size.lineWidth/2;w.style.top=x+"px",a=b.data.markers[v],v>0&&b.data.markers[v]<b.data.markers[v-1]&&(a=b.data.markers[v]+b.data.dayDuration);var y=(60*a-60*d)*h-b.size.markerRadius-b.size.lineWidth;w.style.left=y+"px",j.appendChild(w)}if("true"==b.design.showEvents)for(v=0;v<b.data.events.length;v++){var z=document.createElement("div");z.style.width="14px",z.style.height="14px",a=b.data.events[v].value,v>0&&(b.data.events[v].value<b.data.events[v-1].value||1==c)&&(c=1,a=b.data.events[v].value+b.data.dayDuration);var A=(60*a-60*d)*h-7;z.style.left=A+"px",z.style.top=b.size.paddingTop+b.size.lineWidth/2+b.size.iconPaddingTop+"px",z.style.textAlign="center",z.style.fontFamily=b.design.eventsFontFamily,z.style.position="absolute",z.innerHTML='<i style="color:'+b.data.events[v].color+'" class="fa '+b.data.events[v].icon+'"></i><span style="font-size:10px">'+("true"==b.design.showEventsCaption?b.data.events[v].caption:"")+"<span>",j.appendChild(z)}if($(this).html(j.outerHTML),"true"==b.design.showMarkers)for(var v=0;v<b.data.markers.length;v++){var B=document.getElementById(b.data.prefix+v),C=B.getContext("2d"),D=B.width/2,E=B.height/2,F=b.size.markerRadius;C.beginPath(),C.arc(D,E,F,0,2*Math.PI),C.fillStyle="white",C.fill(),C.lineWidth=b.size.lineWidth,C.strokeStyle=b.design.lineColor,C.stroke()}})},$.fn.cp_vertical_bar=function(a){var b=$.extend(!0,{design:{fillColor:"#009CCC",remainingColor:"#E4E4E4",paddingRight:"1px",showValues:"true",markerFontFamily:"Segoe UI",markerFontSize:"14",markerFontColor:"#FFFFFF",markerPaddingTop:"5px",markerUnit:"",markerValuesLocation:"middle",showAxisValues:"true",axisFontFamily:"Segoe UI",axisFontSize:"14",axisFontColor:"#666666",axisPaddingTop:"3px",axisRotation:"315deg",extraCss:""},size:{barWidth:12,barHeight:50},data:{value:7,maxValue:10,axisValue:"Dec"}},a);return this.each(function(){var a=document.createElement("div");a.style.cssText="width:"+b.size.barWidth+"px;height:"+b.size.barHeight+"px;position:relative;padding-right:"+b.design.paddingRight;var c=document.createElement("div");c.style.height=b.size.barHeight+"px",c.style.width=b.size.barWidth+"px",c.style.position="absolute",c.style.backgroundColor=b.design.remainingColor;var d=document.createElement("div"),e=b.size.barHeight*b.data.value/b.data.maxValue,f=b.size.barHeight-e;d.style.height=e+"px",d.style.top=f+"px",d.style.width=b.size.barWidth+"px",d.style.position="absolute",d.style.backgroundColor=b.design.fillColor;for(p in b.design.extraCss)d.style[b.design.extraCss[p].key]=b.design.extraCss[p].value;if(console.log(b.design.extraCss),a.appendChild(c),a.appendChild(d),"true"==b.design.showValues){var g=document.createElement("div"),h=0;h="above"==b.design.markerValuesLocation||e<1*b.design.markerFontSize+5?f-b.design.markerFontSize-5-b.design.markerFontSize/2:"middle"==b.design.markerValuesLocation?b.size.barHeight-e+e/2-5-b.design.markerFontSize/2:f,g.style.top=h+"px",g.textContent=b.data.value+""+b.design.markerUnit,g.style.width=b.size.barWidth+"px",g.style.position="absolute",g.style.textAlign="center",g.style.fontFamily=b.design.markerFontFamily,g.style.color=b.design.markerFontColor,g.style.fontSize=b.design.markerFontSize+"px",g.style.paddingTop=b.design.markerPaddingTop,a.appendChild(g)}if("true"==b.design.showAxisValues){var i=document.createElement("div");i.style.top=b.size.barHeight+"px",i.textContent=b.data.axisValue,i.style.width=b.size.barWidth+"px",i.style.position="absolute",i.style.textAlign="center",i.style.fontFamily=b.design.axisFontFamily,i.style.color=b.design.axisFontColor,i.style.fontSize=b.design.axisFontSize+"px",i.style.paddingTop=b.design.axisPaddingTop,i.style.transform="rotate("+b.design.axisRotation+")",a.appendChild(i)}$(this).html(a.outerHTML)})},$.fn.cp_vertical_bar_chart=function(a){var b=$.extend(!0,{design:{fillColor:"#009CCC",remainingColor:"#E4E4E4",paddingRight:"5px",showValues:"false",markerFontFamily:"Segoe UI",markerFontSize:"14px",markerFontColor:"#FFFFFF",markerPaddingTop:"5px",markerUnit:"",markerValuesLocation:"above",showAxisValues:"false",axisFontFamily:"Segoe UI",axisFontSize:"14px",axisFontColor:"#666666",axisPaddingTop:"3px",axisRotation:"0deg",graphTitleTopPadding:"20px"},size:{barWidth:"12",barHeight:"50"},data:{values:[],graphTitle:""}},a);return this.each(function(){var a=document.createElement("div");a.style.width="100%";var c=document.createElement("table");c.style.width="100%";var d=document.createElement("tr");a.appendChild(c),c.appendChild(d);for(key in b.data.values){var e=document.createElement("td");e.style.paddingRight=b.design.paddingRight;var f=$("<div>").cp_vertical_bar({design:{fillColor:b.design.fillColor,remainingColor:b.design.remainingColor,paddingRight:b.design.paddingRight,showValues:b.design.showValues,markerFontFamily:b.design.markerFontFamily,markerFontSize:b.design.markerFontSize,markerFontColor:b.design.markerFontColor,markerPaddingTop:b.design.markerPaddingTop,markerUnit:b.design.markerUnit,markerValuesLocation:b.design.markerValuesLocation,showAxisValues:b.design.showAxisValues,axisFontFamily:b.design.axisFontFamily,axisFontSize:b.design.axisFontSize,axisFontColor:b.design.axisFontColor,axisPaddingTop:b.design.axisPaddingTop,axisRotation:b.design.axisRotation,extraCss:b.data.values[key].extraCss},data:{value:b.data.values[key].value,maxValue:b.data.values[key].maxValue,axisValue:b.data.values[key].axisValue},size:{barWidth:b.size.barWidth,barHeight:b.size.barHeight}});e.appendChild(f[0]),d.appendChild(e)}if(""!=b.data.graphTitle){var g=document.createElement("div");g.style.textAlign="center",g.style.fontFamily=b.design.axisFontFamily,g.style.fontFamily=b.design.axisFontFamily,g.style.color=b.design.axisFontColor,g.style.fontSize=b.design.axisFontSize,g.style.paddingTop=b.design.graphTitleTopPadding,g.textContent=b.data.graphTitle,a.appendChild(g)}$(this).html(a.outerHTML)})};